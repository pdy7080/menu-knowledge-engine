# 05. MVP Scope Definition — 무엇을 만들고, 무엇을 만들지 않는가

> **이 문서는 v0.1 MVP의 경계선을 확정한다.**  
> "넣을 것"보다 "넣지 않을 것"이 더 중요하다.

---

## 1. MVP의 단 하나의 목적

> **"Menu Knowledge Engine이 실제로 작동하는가?"를 증명한다.**

증명해야 할 것:
- OCR → 메뉴명 추출이 실용적 수준인가
- DB 매칭 + 수식어 분해가 AI 호출을 줄여주는가
- 외국인이 결과물을 보고 "이해됐다"고 느끼는가
- 식당 사장님이 "이거 쓸 만하네"라고 느끼는가

증명하지 않아도 되는 것 (v0.1에서):
- 대규모 트래픽 처리
- 완벽한 다국어 지원
- 수익 모델 검증
- 성수야 완전 통합

---

## 2. MVP 기능 범위

### ⭕ v0.1에 포함

| # | 기능 | 설명 | 우선순위 |
|---|---|---|---|
| F1 | 메뉴판 OCR | 사진 업로드 → 텍스트 추출 → 메뉴명 리스트 | **P0** |
| F2 | DB 매칭 | 추출된 메뉴명 → canonical_menus 매칭 | **P0** |
| F3 | 수식어 분해 | 매칭 실패 시 modifier 분해 → 추론 | **P0** |
| F4 | AI Identity Discovery | 분해도 실패 시 AI 탐색 → 신규 등록 | **P0** |
| F5 | 다국어 설명 출력 | 영어 설명 (짧은/긴) + 알레르기/맵기 | **P0** |
| F6 | B2B 메뉴 등록 | 사장님이 메뉴 사진 올리면 QR 페이지 생성 | **P1** |
| F7 | B2C 메뉴 스캔 | 외국인이 메뉴판 촬영하면 즉시 설명 | **P1** |
| F8 | 일본어/중국어 출력 | 영어 외 2개 언어 | **P1** |
| F9 | 스캔 로그 기록 | scan_logs 테이블에 행동 데이터 수집 | **P2** |
| F10 | 사장님 수정 기능 | 자동 생성 결과를 사장님이 수정 | **P2** |

### ❌ v0.1에서 제외 (v0.2+ 이후)

| 기능 | 제외 이유 |
|---|---|
| 동남아 언어 (태국어, 베트남어 등) | 초기 커버리지 불필요 |
| 난이도 스코어 대시보드 | 데이터 축적 후 의미 있음 |
| 메뉴 컨설팅 리포트 | 데이터 축적 후 의미 있음 |
| 벡터 유사 검색 (embedding) | trgm + 관계 테이블로 충분 |
| 이미지 AI 생성 (KIMCHI 모델) | 공공 이미지로 대체 |
| 결제/구독 시스템 | 무료 파일럿 기간 |
| 식당 예약 연동 | 핵심 가치와 무관 |
| 네이버지도/구글맵 연동 | Phase 2에서 |
| 문화 개념 노드 (반찬, 곱빼기 등) | 구조만 잡고, 데이터는 Phase 2 |
| 성수야 완전 통합 | 느슨한 연동만 (API 호출) |
| 해외 한식당 지원 | Phase 2에서 |
| PWA (홈화면 설치/오프라인/푸시) | 반복 사용 데이터 확인 후 검토 |
| 실시간 카메라 라이브뷰 (getUserMedia) | iOS 제약/버그 많음, 파일 업로드로 충분 |

---

## 3. 기술 스택 확정

### 아키텍처

```
[클라이언트]
  B2B: 간단한 웹 대시보드 (메뉴 업로드 + QR 생성)
  B2C: 모바일웹 (사진 업로드 기반 → 결과 표시, PWA 아님)
       │
       │ HTTPS
       ▼
[API 서버]
  FastAPI (Python 3.11+)
  - /api/v1/menu/recognize     (OCR + 파싱)
  - /api/v1/menu/identify      (DB매칭 + 수식어분해 + AI fallback)
  - /api/v1/menu/translate     (다국어 출력)
  - /api/v1/shop/register      (식당 등록)
  - /api/v1/qr/generate        (QR 페이지 생성)
       │
       ├──► CLOVA OCR API (네이버)
       ├──► GPT-4o API (OpenAI) — Identity Discovery용
       ├──► Papago API (일/중 번역 보조)
       │
       ▼
[데이터베이스]
  PostgreSQL 16+
  - pgvector 확장 (v0.2에서 활성화)
  - pg_trgm 확장 (유사 검색)
       │
       ▼
[스토리지]
  S3 호환 (메뉴판 이미지, QR 코드 이미지)
```

### 기술 선택 근거

| 항목 | 선택 | 대안 | 선택 이유 |
|---|---|---|---|
| 백엔드 | FastAPI | Django, Express | AI/ML 생태계(Python), 비동기 지원, 자동 API 문서 |
| 프론트 (B2C) | Next.js 모바일웹 | React Native, PWA | 설치 불필요가 핵심, 파일 업로드 기반 카메라(iOS 호환성↑) |
| 프론트 (B2B) | Next.js | 별도 앱 | B2C와 코드 공유, 빠른 개발 |
| OCR | CLOVA OCR | Google Vision | 한국어 1위 성능, 손글씨/디자인폰트 강점 |
| LLM | GPT-4o | Claude, HyperCLOVA X | 다국어 음식 설명 품질, function calling |
| 번역 보조 | Papago | DeepL, Google | 일/중 한국어 번역 최고 품질 |
| DB | PostgreSQL | MySQL, MongoDB | pgvector/pg_trgm 확장, JSONB, PostGIS |
| 호스팅 | Naver Cloud | AWS | CLOVA OCR 동일 네트워크, 국내 레이턴시 |

### 비용 추정 (월간, MVP 규모)

| 항목 | 단가 | 예상 사용량 | 월 비용 |
|---|---|---|---|
| CLOVA OCR | ~15원/건 | 1,000건 | ~15,000원 |
| GPT-4o (Identity Discovery) | ~$0.01/요청 | 300건 (신규 메뉴) | ~$3 (~4,000원) |
| GPT-4o (설명 생성) | ~$0.02/요청 | 300건 | ~$6 (~8,000원) |
| Papago API | 무료 (일 10,000자) | 초기 충분 | 0원 |
| PostgreSQL (Naver Cloud) | ~50,000원/월 | 최소 사양 | ~50,000원 |
| S3 스토리지 | ~23원/GB | 10GB | ~230원 |
| **합계** | | | **~8만 원/월** |

> **월 8만 원으로 MVP 운영 가능.** DB에 메뉴가 쌓일수록 AI 호출 비율 하락 → 비용 더 감소.

---

## 4. 초기 데이터 구축 범위

### Concept 트리 (대분류 12 + 중분류 ~50)

```
국물요리
  ├── 탕 (곰탕, 갈비탕, 삼계탕, 육개장, 뼈해장국...)
  ├── 국 (미역국, 시래기국, 된장국, 콩나물국...)
  ├── 찌개 (김치찌개, 된장찌개, 순두부찌개, 부대찌개...)
  └── 전골 (버섯전골, 곱창전골, 해물전골...)
밥류
  ├── 비빔밥 (전주비빔밥, 돌솥비빔밥...)
  ├── 덮밥 (제육덮밥, 오징어덮밥...)
  ├── 볶음밥 (김치볶음밥, 새우볶음밥...)
  └── 죽 (호박죽, 전복죽, 잣죽...)
면류
  ├── 국수 (잔치국수, 비빔국수, 칼국수...)
  ├── 냉면 (물냉면, 비빔냉면, 밀면...)
  └── 라면 (라면, 라볶이...)
구이류
  ├── 고기구이 (삼겹살, 목살, 갈비, 불고기...)
  └── 생선구이 (고등어구이, 갈치구이...)
찜/조림류 (갈비찜, 안동찜닭, 해물찜, 장조림...)
볶음류 (제육볶음, 오징어볶음, 떡볶이...)
전/부침류 (파전, 김치전, 빈대떡, 동그랑땡...)
반찬류 (나물, 김치, 젓갈, 장아찌...)
분식류 (떡볶이, 순대, 만두, 어묵, 김밥...)
안주류 (족발, 보쌈, 닭발, 골뱅이무침...)
음료류 (막걸리, 소주, 식혜, 수정과...)
디저트류 (호떡, 붕어빵, 인절미, 약과...)
```

### Canonical Menu 100개 (MVP 핵심 메뉴)

선정 기준: **"외국인이 한국에서 가장 자주 마주치는 100개 메뉴"**

```
[국물] 김치찌개, 된장찌개, 순두부찌개, 부대찌개, 삼계탕, 감자탕,
       뼈해장국, 곰탕, 설렁탕, 갈비탕, 육개장, 미역국, 떡국,
       된장국, 콩나물국밥, 해물탕, 매운탕, 갈비찜

[밥]   비빔밥, 돌솥비빔밥, 김치볶음밥, 제육덮밥, 김밥,
       충무김밥, 삼각김밥, 전복죽, 호박죽

[면]   잔치국수, 칼국수, 물냉면, 비빔냉면, 짜장면, 짬뽕,
       라면, 비빔국수, 수제비

[구이] 삼겹살, 목살, 소갈비, 돼지갈비, 불고기, 닭갈비,
       고등어구이, 제육볶음, 오리구이

[전]   파전, 해물파전, 김치전, 빈대떡, 감자전

[분식] 떡볶이, 순대, 만두 (찐/군/물), 어묵, 호떡, 붕어빵,
       라볶이, 튀김 (모듬)

[반찬] 김치, 깍두기, 잡채, 나물 (시금치/콩나물/도라지),
       계란말이, 멸치볶음

[안주] 족발, 보쌈, 닭발, 치킨 (양념/후라이드), 골뱅이무침,
       오징어볶음, 닭볶음탕, 감자탕

[음료] 소주, 맥주, 막걸리, 식혜, 수정과, 매실차, 유자차

[기타] 떡갈비, 한정식, 백반, 쌈밥, 국밥,
       순대국밥, 돼지국밥, 해장국, 곱창, 대창
```

### 수식어 사전 v0.1 (50개)

```
[맛 taste - 12개]
얼큰, 매운, 순, 담백한, 달콤한, 시원한, 새콤한,
고소한, 짭짤한, 칼칼한, 알싸한, 구수한

[크기/양 size - 7개]
왕, 대, 소, 곱빼기, 반, 미니, 점보

[감성/브랜드 emotion - 10개]
할머니, 옛날, 시골, 원조, 본가, 맛있는,
엄마손, 고향, 전통, 명품

[재료 ingredient - 10개]
한우, 해물, 야채, 순두부, 치즈, 묵은지,
모듬, 날치알, 계란, 버섯

[조리법 cooking - 6개]
불, 숯불, 직화, 수제, 생, 통

[등급 grade - 3개]
특, 프리미엄, 스페셜

[지역 origin - 2개]
궁중, 부산
```

---

## 5. AI 프롬프트 설계 — 2종

### 프롬프트 A: Identity Discovery (메뉴 정체성 확정)

**목적:** 미지의 메뉴명을 조사하여 구조화된 개념 객체로 변환

```
System:
당신은 한국 음식 전문가입니다.
주어진 한국 메뉴명을 분석하여 아래 JSON 형식으로 정확한 정보를 제공하세요.
확신할 수 없는 정보는 null로 남기세요.

User:
메뉴명: "{menu_name_ko}"
식당 정보 (있는 경우): {shop_context}

아래 JSON 형식으로 응답하세요:
{
  "name_ko": "표준 메뉴명 (한국어)",
  "name_en": "English name",
  "romanization": "로마자 표기",
  "concept_category": "국물요리|밥류|면류|구이류|찜조림|볶음류|전부침|반찬류|분식류|안주류|음료류|디저트류",
  "subcategory": "세부 분류 (탕, 찌개, 비빔밥 등)",
  "explanation_short_en": "한 문장 영어 설명 (외국인 대상)",
  "explanation_long_en": "3~5문장 상세 설명 (재료, 맛, 먹는 방법 포함)",
  "cultural_context_en": "문화적 배경 설명 (왜 이 음식이 특별한가)",
  "main_ingredients": [
    {"ko": "재료명_한국어", "en": "ingredient_english"}
  ],
  "allergens": ["pork|beef|chicken|seafood|shellfish|eggs|milk|wheat|soy|peanuts|sesame"],
  "dietary_tags": ["contains_pork|spicy|mild|vegan|vegetarian|gluten_free"],
  "spice_level": 0~5,
  "serving_style": "제공 형태 설명",
  "typical_price_range": "최소~최대 (원)",
  "similar_dishes": ["유사 메뉴명 (한국어)"],
  "often_confused_with": ["혼동되는 메뉴 (있으면)"],
  "name_trap_warning": "직역 시 오해 가능성 (있으면)",
  "confidence": 0.0~1.0,
  "confidence_reason": "확신도 판단 근거"
}
```

**출력 → DB 매핑:**
| AI 출력 필드 | → DB 테이블.컬럼 |
|---|---|
| name_ko, name_en | canonical_menus.name_ko, name_en |
| concept_category | concepts 테이블 매칭 → canonical_menus.concept_id |
| explanation_short_en | canonical_menus.explanation_short.en |
| main_ingredients | canonical_menus.main_ingredients |
| allergens | canonical_menus.allergens |
| similar_dishes | menu_relations (similar_to) |
| confidence | canonical_menus.ai_confidence |
| (전체 응답) | evidences (AI 근거 기록) |

---

### 프롬프트 B: Menu Decomposition Assist (수식어 분해 보조)

**목적:** 수식어 분해 알고리즘이 실패했을 때 AI가 보조

```
System:
당신은 한국 메뉴명 분석 전문가입니다.
복합 메뉴명을 구성 요소로 분해해주세요.

User:
메뉴명: "{complex_menu_name}"

아래 JSON 형식으로 응답하세요:
{
  "original": "원본 메뉴명",
  "base_menu": "기본 메뉴명 (수식어 제거 후)",
  "modifiers": [
    {
      "text": "수식어 텍스트",
      "type": "taste|size|emotion|ingredient|cooking|grade|origin|composition",
      "meaning_en": "영어 의미",
      "position": "prefix|suffix"
    }
  ],
  "composed_name_en": "조합된 영어 이름",
  "decomposition_confidence": 0.0~1.0
}
```

---

## 6. 검증 지표 (MVP Success Criteria)

### 핵심 KPI — 3개월 후 판단 기준

| 지표 | 목표 | 측정 방법 |
|---|---|---|
| **DB 매칭률** | 70%+ | scan_logs에서 ai_called=false 비율 |
| **외국인 이해도** | 4/5+ | 결과 화면 하단 "Was this helpful?" 피드백 |
| **사장님 수정률** | 20% 이하 | B2B 업로드 후 수정 클릭 비율 |
| **OCR 인식률** | 80%+ | 메뉴명 추출 성공 / 전체 메뉴 수 |
| **응답 시간** | DB히트 3초 이내 | 서버 로그 p95 |

### 보조 KPI

| 지표 | 목표 | 의미 |
|---|---|---|
| 등록 Canonical 수 | 500+ | DB 커버리지 |
| 수식어 사전 크기 | 100+ | 자동 분해 능력 |
| B2C 일일 스캔 수 | 30+ | 사용자 수요 존재 여부 |
| AI 비용/스캔 | < 50원 | 비용 구조 지속가능성 |
| 신규 메뉴 발견률 | 주 20+ | 엔진 자동 성장 속도 |

---

## 7. MVP 개발 일정 (12주)

```
Week:  1    2    3    4    5    6    7    8    9   10   11   12
       │    │    │    │    │    │    │    │    │    │    │    │
DB:    ████████                                              스키마+시드
OCR:        ████████                                         파이프라인
매칭:            ████████                                     DB매칭+분해
AI:                  ████████                                 Discovery
B2B:                      ████████████                       업로드+QR
B2C:                           ████████████                  촬영+결과
테스트:                              ████████████████          현장검증
       │    │    │    │    │    │    │    │    │    │    │    │

마일스톤:
  W2:  DB 스키마 완성 + 100개 메뉴 시드 데이터
  W4:  OCR → 매칭 파이프라인 작동
  W6:  AI Discovery 포함 전체 파이프라인 작동
  W8:  B2B/B2C 프론트엔드 작동
  W10: 현장 테스트 시작 (명동 10개 식당)
  W12: MVP 완성 + 데이터 리포트
```

### 주차별 세부

**Week 1~2: 데이터 기반**
- PostgreSQL + 확장(pg_trgm) 설정
- 03_data_schema 기반 테이블 생성
- Concept 트리 시드 데이터 입력
- Canonical 100개 + Modifier 50개 수동 + AI 생성

**Week 3~4: OCR 파이프라인**
- CLOVA OCR API 연동
- 메뉴판 이미지 → 텍스트 추출
- LLM 후처리 (메뉴명/가격 분리)
- 테스트 메뉴판 50장으로 정확도 측정

**Week 5~6: 매칭 엔진**
- DB 매칭 로직 (정확매칭 → trgm → 수식어 분해)
- AI Identity Discovery 연동
- confidence 기반 자동/수동 분기
- evidence 기록 파이프라인

**Week 7~8: 프론트엔드**
- B2B: 메뉴 업로드 웹 + QR 코드 생성
- B2C: PWA 웹앱 (카메라 → 결과)
- 다국어 설명 표시 (영/일/중)

**Week 9~10: 통합 테스트**
- 명동 식당 10곳 실제 메뉴판으로 End-to-End 테스트
- 외국인 대상 사용성 테스트 (5~10명)
- 버그 수정 + OCR 정확도 개선

**Week 11~12: 최적화 + 리포트**
- 현장 피드백 반영
- 성능 최적화 (캐싱, 응답 시간)
- KPI 리포트 작성
- v0.2 범위 확정

---

## 8. 즉시 실행 항목 (내일부터)

### Priority 0 — 이번 주 안에

- [ ] PostgreSQL 로컬 환경 구축 + 스키마 생성
- [ ] Concept 트리 시드 데이터 작성 (대분류 12 + 중분류 50)
- [ ] Canonical 메뉴 100개 리스트 최종 확정
- [ ] CLOVA OCR API 키 발급 + 테스트 호출
- [ ] GPT-4o Identity Discovery 프롬프트 테스트 (10개 메뉴)

### Priority 1 — 2주 안에

- [ ] Canonical 100개 개념 객체 생성 (AI + 수동 검수)
- [ ] Modifier 50개 수동 입력
- [ ] 메뉴판 사진 20장 수집 (명동/성수)
- [ ] OCR → 매칭 파이프라인 프로토타입

### Priority 2 — 1개월 안에

- [ ] B2C PWA 웹앱 프로토타입
- [ ] B2B 업로드 화면 프로토타입
- [ ] 현장 테스트 식당 5곳 섭외

---

## 9. 리스크 대응 (MVP 단계)

| 리스크 | 확률 | 영향 | 대응 |
|---|---|---|---|
| OCR이 손글씨 메뉴판 인식 못함 | 높음 | 중 | LLM 후처리 + "깨끗한 사진 안내" UX + 수동 입력 fallback |
| DB 매칭률이 목표(70%) 미달 | 중 | 높음 | 수식어 사전 확대 + trgm 임계값 조정 + AI fallback 허용 |
| 외국인이 서비스를 못 찾음 | 중 | 높음 | QR 코드 스티커 물리 배포 + 구글맵 SEO |
| 사장님 무관심 | 중 | 중 | "2시간 내 무료 완성" 제안 + 결과물 먼저 보여주기 |
| AI 비용 초과 | 낮음 | 중 | 월 8만 원 수준, 300건/월 이내 관리 |
| 번역 품질 불만 | 중 | 중 | 피드백 버튼 + 주간 품질 리뷰 + evidence 추적 |

---

## 부록: 이 설계 문서와 이전 단계의 관계

```
[1차 조사] → 시장 기회 확인 ("빈자리가 있다")
     │
     ▼
[2차 브레인스토밍] → 전략 방향 수립 ("지식 엔진이어야 한다")
     │
     ▼
[3차 설계 문서 (현재)] → 구조 확정 ("이렇게 만든다")
     │
     ▼
[다음: 구현] → 코드 작성 ("만든다")
```

> **이 설계 문서가 "상상"과 "구현" 사이의 다리다.**
